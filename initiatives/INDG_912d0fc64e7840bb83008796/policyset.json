{
 "properties": {
  "displayName": "INDG",
  "policyType": "Custom",
  "description": "Draft Azure Policy",
  "metadata": {
   "category": "INDG",
   "parameterScopes": {
    "listOfResourceTypesNotAllowed": "/subscriptions/66dc4c15-bb63-4119-acff-e8f8666fee1c"
   },
   "createdBy": "aad03f01-166f-4440-b3b1-9ad6a578209a",
   "createdOn": "2022-01-13T03:48:19.1929239Z",
   "updatedBy": null,
   "updatedOn": null
  },
  "parameters": {},
  "policyDefinitions": [
   {
    "policyDefinitionReferenceId": "Certificates using RSA cryptography should have the specified minimum key size_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0",
    "parameters": {
     "minimumRSAKeySize": {
      "value": 2048
     }
    },
    "groupNames": [
     "Encryption"
    ]
   },
   {
    "policyDefinitionReferenceId": "Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resou_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
    "parameters": {},
    "groupNames": [
     "Encryption"
    ]
   },
   {
    "policyDefinitionReferenceId": "Transparent Data Encryption on SQL databases should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
    "parameters": {},
    "groupNames": [
     "Encryption"
    ]
   },
   {
    "policyDefinitionReferenceId": "Key vaults should have soft delete enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
    "parameters": {},
    "groupNames": [
     "Encryption"
    ]
   },
   {
    "policyDefinitionReferenceId": "Key Vault keys should have an expiration date_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
    "parameters": {},
    "groupNames": [
     "Encryption"
    ]
   },
   {
    "policyDefinitionReferenceId": "Key Vault secrets should have an expiration date_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
    "parameters": {},
    "groupNames": [
     "Encryption"
    ]
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Certificates should have the specified maximum validity period_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560",
    "parameters": {},
    "groupNames": [
     "Encryption"
    ]
   },
   {
    "policyDefinitionReferenceId": "System updates should be installed on your machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60",
    "parameters": {},
    "groupNames": [
     "IT General Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "Email notification for high severity alerts should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6e2593d9-add6-4083-9c9b-4b7d2188c899",
    "parameters": {},
    "groupNames": [
     "IT General Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "Azure Backup should be enabled for Virtual Machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/013e242c-8828-4970-87b3-ab247555486d",
    "parameters": {},
    "groupNames": [
     "IT General Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "Secure transfer to storage accounts should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "FTPS should be required in your Web App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "FTPS only should be required in your API App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9a1b8c48-453a-4044-86c3-d8bfd823e4f5",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "FTPS only should be required in your Function App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "Web Application should only be accessible over HTTPS_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "API App should only be accessible over HTTPS_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b7ddfbdc-1260-477d-91fd-98bd9be789a6",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "Latest TLS version should be used in your Web App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "Latest TLS version should be used in your API App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "Management ports should be closed on your virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "Subnets should be associated with a Network Security Group_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "All network ports should be restricted on network security groups associated to your virtual machine_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "Non-internet-facing virtual machines should be protected with network security groups_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bb91dfba-c30d-4263-9add-9c2384e659a6",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "[Preview]: All Internet traffic should be routed via your deployed Azure Firewall_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fc5e4038-4584-4632-8c85-c0448d374b2c",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "IP Forwarding on your virtual machine should be disabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Storage account public access should be disallowed_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "Storage accounts should restrict network access using virtual network rules_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "Storage accounts should restrict network access_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "Private endpoint connections on Azure SQL Database should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7698e800-9299-47a6-b3b6-5a0fee576eed",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "Management ports of virtual machines should be protected with just-in-time network access control_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
    "parameters": {},
    "groupNames": [
     "Network"
    ]
   },
   {
    "policyDefinitionReferenceId": "MFA should be enabled on accounts with owner permissions on your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "MFA should be enabled accounts with write permissions on your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "A maximum of 3 owners should be designated for your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "Deprecated accounts with owner permissions should be removed from your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "There should be more than one owner assigned to your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "MFA should be enabled on accounts with read permissions on your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "Deprecated accounts should be removed from your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "Managed identity should be used in your Function App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "Managed identity should be used in your Web App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "Managed identity should be used in your API App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c4d441f8-f9d9-4a9e-9cef-e82117cb3eef",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "External accounts with write permissions should be removed from your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "External accounts with read permissions should be removed from your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "External accounts with owner permissions should be removed from your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9",
    "parameters": {},
    "groupNames": [
     "System Access Control"
    ]
   },
   {
    "policyDefinitionReferenceId": "System updates should be installed on your machines_2",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "A vulnerability assessment solution should be enabled on your virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Vulnerability assessment should be enabled on your SQL servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Require a tag on resources_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/871b6d14-10aa-478d-b590-94f262ecfa99",
    "parameters": {
     "tagName": {
      "value": "Department"
     }
    },
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Not allowed resource types_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
    "parameters": {
     "listOfResourceTypesNotAllowed": {
      "value": [
       "crypteron.datasecurity/apps"
      ]
     }
    },
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Endpoint protection should be installed on your machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f7c564c-0a90-4d44-b7e1-9d456cffaee8",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for Storage should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/308fbb08-4ab8-4e67-9b29-592e93fb94fa",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for Key Vault should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for App Service should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2913021d-f2fd-4f3d-b958-22354e2bdbcb",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for SQL should be enabled for unprotected Azure SQL servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Resource logs in Key Vault should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Network Watcher should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Resource logs in App Services should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/91a78b24-f231-4a8a-8da9-02c35b2b6510",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Resource logs in Key Vault should be enabled_2",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Resource logs in Virtual Machine Scale Sets should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "SQL servers with auditing to storage account destination should be configured with 90 days retention_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   },
   {
    "policyDefinitionReferenceId": "Auditing on SQL server should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
    "parameters": {},
    "groupNames": [
     "Digital Project Infra"
    ]
   }
  ],
  "policyDefinitionGroups": [
   {
    "name": "Encryption"
   },
   {
    "name": "IT General Control"
   },
   {
    "name": "Network"
   },
   {
    "name": "System Access Control"
   },
   {
    "name": "Digital Project Infra"
   }
  ]
 },
 "id": "/subscriptions/66dc4c15-bb63-4119-acff-e8f8666fee1c/providers/Microsoft.Authorization/policySetDefinitions/912d0fc64e7840bb83008796",
 "type": "Microsoft.Authorization/policySetDefinitions",
 "name": "912d0fc64e7840bb83008796"
}